<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>ÅarkÄ± UygulamasÄ±</title>
<link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
<div class="container">
    <h1>ğŸµ ÅarkÄ± KitaplÄ±ÄŸÄ±</h1>
    <div class="search-box">
        <input type="text" id="search" placeholder="ÅarkÄ± ara...">
        <button onclick="searchSong()">Ara</button>
    </div>
    <div id="results" class="results"></div>

    <h2>Favoriler â¤ï¸</h2>
    <div id="favorites" class="favorites"></div>
</div>

<script>
async function searchSong() {
    const query = document.getElementById('search').value;
    const res = await fetch(`/search?q=${query}`);
    const songs = await res.json();
    const container = document.getElementById('results');
    container.innerHTML = '';
    songs.forEach(song => {
        const div = document.createElement('div');
        div.className = 'song';
        div.innerHTML = `
            <span>${song.title} - ${song.artist}</span>
            <span class="like ${song.liked ? 'liked' : ''}" onclick="toggleFavorite(${song.id}, this)">â¤ï¸</span>`;
        container.appendChild(div);
    });
}

async function toggleFavorite(id, el) {
    const res = await fetch('/favorites', {
        method: 'POST',
        headers: {'Content-Type':'application/json'},
        body: JSON.stringify({id})
    });
    const data = await res.json();
    el.classList.toggle('liked', data.liked);
    loadFavorites();
}

async function loadFavorites() {
    const res = await fetch('/favorites');
    const songs = await res.json();
    const container = document.getElementById('favorites');
    container.innerHTML = songs.map(s => `<div>${s.title} - ${s.artist}</div>`).join('');
}

loadFavorites();
</script>
</body>
</html>
